这部分内容并不属于书本内容，是基于书本内容的扩展。

## 高可用
在说道高可用的时候，由于nginx对外需要提供统一的服务，因此紧紧是采用master-slave结构，同时工作的仅仅只有一台nginx，如果nginx达到性能瓶颈了怎么办呢？最近看到一篇文章[不懂高性能的负载均衡设计](https://mp.weixin.qq.com/s/0AlKccc6bY8dx8qgLDfpdg)，解开了我的疑惑，大概内容如下：

nginx方案有几种，接触的最多的nginx负载均衡是基于软件的负载均衡
* 基于DNS负载均衡
* 基于硬件负载均衡
* 基于软件负载均衡

基于DNS来做负载均衡其实是一种最简单的实现方案，通过在DNS服务器上做一个简单配置即可。其原理就是当用户访问域名的时候，会先向DNS服务器去解析域名对应的IP地址，这个时候我们可以让DNS服务器根据不同地理位置的用户返回不同的IP。比如南方的用户就返回我们在广州业务服务器的IP，北方的用户来访问的话，我就返回北京业务服务器所在的IP。

硬件的负载均衡那就比较牛逼了，比如大名鼎鼎的 F5 Network Big-IP，也就是我们常说的 F5，它是一个网络设备，你可以简单的理解成类似于网络交换机的东西，完全通过硬件来抗压力，性能是非常的好，每秒能处理的请求数达到百万级，即 几百万/秒 的负载，当然价格也就非常非常贵了，十几万到上百万人民币都有。

软件负载均衡是指使用软件的方式来分发和均衡流量。软件负载均衡，分为7层协议 和 4层协议。

网络协议有七层，基于第四层传输层来做流量分发的方案称为4层负载均衡，例如 LVS，而基于第七层应用层来做流量分发的称为7层负载均衡，例如 Nginx。这两种在性能和灵活性上是有些区别的。

基于4层的负载均衡性能要高一些，一般能达到 几十万/秒 的处理量，而基于7层的负载均衡处理量一般只在 几万/秒 。

常用的均衡算法有哪些
* 轮询策略：将请求轮流的转发到后端不同的业务服务器上
* 负载度策略
* 响应策略
* 哈希策略
Diff 算法
* react 技术揭秘：https://react.iamkasong.com/
* https://zhuanlan.zhihu.com/p/20346379
* https://github.com/aooy/blog/issues/2
* http://blog.vjeux.com/2013/javascript/react-performance.html

设备分辨率、物理分辨率

响应式设计 - 小狄

如何判断循环引用
* Set WeakSet
* Map WeakMap

yield 报错后不再进入问题

canvas globalCompositeOperation 了解

node 书写命令行工具
* commander：命令行开发工具
* chalk：命令行样式风格控制器
* inquirer：交互式命令行工具

## Cad 识别
ODA 优势
* 多文件格式
* 网页端渲染模型
* 图纸批注与标签
* 图纸测量
  * 两点之间距离
  * 某个多边形区域的面积
  * 某个角度大小
  * 为了适应用户的习惯，测量时可以捕捉端点、中点、垂足及线条。
* 图层列表与管理

VisualizeJS
* 渲染 Open Cloud 解析后的图形
* getVisualizeLibInst 获取实例
  * urlMemFile：Visualize.js.wasm 文件
  * TOTAL_MEMORY：所需的浏览器内存量
* visualizeLibInstance
  * postRun：准备就绪回调
  * canvas：执行用于绘制的 canvas 对象
  * getOverlayController
  * getViewer
* Viewer：单实例类
  * resize
  * update
  * addEmbedetFileWrapper
  * appendFileWrapper
  * createBlock、createLayer、createLocalDatabase、createModel、createRasterImage、createTextStyle、createVisualStyle
  * findXXX
* 插件机制
  * OdaViewer plugin：集成平移、缩放、镜头控制等
  * OdaSlicePlane plugin：
  * OdaMeasuring plugin：测量工具
  * OdaWorkerTransport plugin

Layer、Block、Entity、Model
* Entity 表示图形单元，通过 layer 属性关联具体的 layer
* Block 多个 Entity 组成一个 Model，有点 Template 的味道
* Layer 主要用于管理该图层下的 Entity
* Model

如何读取文件并显示
1. 上传文件到服务端得到一个 fileId
2. 使用 fileId 创建一个从文件中解析图形的任务，得到 jobId
3. 根据 jobId 轮训任务状态，直到任务完成
4. 使用 viewer api 直接渲染图形数据

坐标体系变换
1.
2.

常用矩阵
* view.projectionMatrix：投影矩阵
* view.worldToDeviceMatrix：世界坐标转屏幕坐标
* view.eyeToWorldMatrix：视图矩阵的逆矩阵，用于将视图坐标转回世界坐标
* view.viewingMatrix：视图矩阵，用于将世界坐标转视图坐标

```js
function printMatrix(matrix) {
  const result = []
  for (let i = 0; i < 4; i++ ) {
    for (let j = 0; j < 4; j++) {
      result.push(matrix.get(i, j));
    }
  }
  console.log(result)
}
// 1000 * 610
var a = lib.Point3d.createFromArray([1,1,0]);
a.transformBy(viewer.activeView.worldToDeviceMatrix); // [458.2600819854454, 159.3051914642516, 0.5]

var b = lib.Point3d.createFromArray([1,1,0]);
b.transformBy(viewer.activeView.viewingMatrix.postMultBy(viewer.activeView.projectionMatrix)); // [-1.3438006824319886, 2.685724923501441, 0.5]

var b = lib.Point3d.createFromArray([1,1,0]);
b.transformBy(viewer.activeView.viewingMatrix.preMultBy(viewer.activeView.projectionMatrix)); // [0.4582600819854455, 0.7388439484192596, 0.5]

// 转 NDC 坐标 x = [-1, 1] y = [-1, 1] 下面的目的是将 [0, 1] 的范围扩展到 [-1, 1]
// Xn = 0.4582600819854455 * 2 - 1 = -0.08347983602910902
// 转设备坐标
// -0.08347983602910902 * 1000 / 2 + 1000 / 2 === 直接通过 worldToDeviceMatrix 直接获取的值

// Yn = 0.7388439484192596 * 2 - 1 = 0.4776878968385192
// 转设备坐标
// 0.4776878968385192 * -610 / 2 + 305 = 159.30519146425164
```

相关函数
* viewer.toEyeToWorld(x, y, z)
* viewer.screenToWorld(x, y)
* point3d.transformBy(matrix)
* viewer.getTransform(from, to)

变化操作：空间区别
* 局部空间：3D 模型的坐标。定义了 3D 模型本身的顶点空间
* 世界空间：将局部空间坐标 * 世界矩阵从而进入到世界空间。是我们想象中的 3D 世界，没有考虑任何视角
* 视图空间：局部顶点 * 世界矩阵 * 视图矩阵从而进入到视图空间。这是坐标在屏幕上的位置，和具体使用的视角有关。如果您使用透视投影，这会使所有坐标看起来像它们具有深度
* 投影矩阵：用投影矩阵 * 上述结果后，将获取到 3D 透视点，并将其正确映射到 2D 窗口
* NDC 坐标：也叫做设备无关坐标

## Map
Mapbox 中国
* 中国地图服务
* 全球化的地图和数据
* 更改地图的每一个像素，更可以叠加上你的数据图层
* 教程
  * [Mapbox GL JS](http://www.mapbox.cn/mapbox-gl-js/api/)
  * [初步了解 Mapbox](http://www.mapbox.cn/help/how-mapbox-works/)

## maptalks
新版本 0.49.1 相比目前使用版本主要变化
* 为了更好的兼容三维渲染，世界坐标系改为与 opengl 坐标系一致

坐标转换
* distanceToVector3
* coordinateToVector3

## 优化接口请求
request 优化
* 增强错误默认处理
  * HTTP 状态码非 200 区间时走默认错误处理
  * success 为 false 时走默认错误处理
  * 增加 skipErrorHandler 参数，针对不需要默认处理的接口情况
* 判断是否是新接口，暂采用直接判断是否定义 success 和 errorCode 字段
* 数据返回问题
  * 状态码为 200 且 success 字段为 true 时，直接返回 data.data，这样原有接口使用逻辑不变
  * 其他情况，直接 reject error 对象，有 errorMessage、errorCode、type（用于区分是不是 success 为 false 抛出的错误）
* 新增请求配置参数
  * loading
  * getResponse
  * skipErrorHandler
* 管理多个 request 对象
* 完整的 response 响应结构
  * data
  * status
  * statusText
  * headers
  * config
  * request
* 中间件、拦截器
  * 拆分多个拦截器，每个只做一件事
  * 全局配置：axios 的全局配置竟然是失效的！！！
  * 实例单独配置
* 缓存功能设计
  * 缓存开关：useCache
  * 缓存时间：ttl
  * 缓存 key：url + params + method
  * 最大缓存数：maxCache
  * 自定义缓存：validateCache
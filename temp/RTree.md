MBR，Minimun Bounding Rectangle：MBR 本身通过 x、y 坐标容易计算，计算 MBR 相交也十分简单高效，适用于应用在索引结构中

R-Tree 特点（R 表示 Rectangle）
* 由单个根、内部节点和叶节点组成，所有叶子节点都位于同一层，因此 R 树为平衡树
* 根包含指向空间域中的最大区域的指针
* 父节点包含指向子节点的指针，其中子节点的区域与父节点的区域完全重叠
* 叶子节点包含到当前对象的 MBR 数据
* MBR 最小边界区域是指围绕所考虑的区域/对象的最小边界框参数
* 子节点数量有限制即存在节点分裂和合并

R 树与 B 树最显著的区别在于 R 树在非一维空间使用 MBR 描述节点的上下界，无法像 B 树节点一样准确适应子节点的分布。虽然通过通过 MBR 提高了计算和求交的效率，不过这也势必牺牲了空间利用率（父节点包含了空白区域）及查询效率（兄弟节点 MBR 可能会重叠）

B 树是一棵平衡树，它是把一维直线分为若干段线段，当我们查找满足某个要求的点的时候，只要去查找它所属的线段即可。这种思想其实就是先找一个大的空间，再逐步缩小所要查找的空间，最终在一个自己设定的最小不可分空间内找出满足要求的解。

常用空间查询方式
* 窗口查询：给定一个查询窗口（通常是一个矩形），返回与查询窗口相重叠的物体
* 点查询：给定一个点，返回包含这个点的所有几何图形

R-Tree 与四叉树（Quad-trees）比较
* 四叉树需要平铺层优化，而 R-Tree 不需要任何此类优化
* 四叉树可以在现有的 B-Tree 上实现，而 R-Tree 遵循与 B-Tree 不同的结构
* 四叉树空间索引创建速度比 R-Tree 快
* 对于最近邻居查询，R-Tree 比四叉树快，而对于窗口查询，四叉树比 R-Tree 快

通用规则
* 点索引可以使用网格索引 KDTree（k-dimensional tree）
  * tree 的每一层，依次选一个维度把空间二分
  * 仅限点，不支持矩形
  * 静态的，不支持增删元素
  * 索引快 5-8 倍
* 线面索引使用 STRTree（Sort-Tile-Recursive Tree 递归网格排序） 或者 QuadTree
  * QuadTree 依次将每个子空间分层 4 份，直到不需要再分位置
  * 支持点，也支持矩形，用于表示任何几何对象

Grid Index：将要考虑的空间铺好网格，一遍快速锁定区间。适合做近邻搜索。

当面对大规模的空间数据时，一个最有效也是最重要的方法就是空间索引（Spatial Index）。

空间索引一系列可以通过排列几何数据来进行高效索引的算法，例如查询本区域所有的建筑，距此点最近的 1000 个加油站等问题，要求结果能在几毫秒内返回，即使所要查询的目标由几百万个。

空间数据有两种基础查询类型：最相邻查询和范围查询

最原始的处理方式
* 最朴素的方法：遍历计算再排序
* 针对复杂图形，如不规则多边形，则先转换为简单的包围盒判断，再进一步做复杂判断
* 网格查表法
* 建立空间索引

大规模地解决这两种问题时就需要将数据点转换到空间索引中。由于数据转变的频率会远远少于查询的频率，因此将数据转变到空间索引的花销对于之后的快速搜索是非常值得的。

几乎所有的空间数据结构都具有相同的原理，以实现有效的搜索：分支和绑定（https://en.wikipedia.org/wiki/Branch_and_bound）。数据被排列在一个树状结构中，因此当在某一节点的某一分支不符合查询条件时，该分支之下的所有的节点都可被略过。

K 相邻查询
* 对于特点查询点，如何判断哪棵子树上的节点与该节点最相邻呢？最相邻的点可能在树中里查询点很远的位置
* 优先队列：维护一个有序列表，将最小的元素以很快的速度提取出来
  * 与查询点更临近的矩形框可能有我们想要搜索的点，按从近到远的顺序将最大的矩形框排在队列中，从顶层开始进行搜索
  * 打开相邻的矩形框，从队列中移除，并将它的孩子节点放到队列中与其相邻的位置上
  * 重复上述步骤，当从队列中移除的相邻项是真正的点，而不是矩形框时，这就是我们要查找的点，队列顶部的第二个点就是第二个最相邻的点，依次类推
  * 扩展：不仅实现点对点，也可以扩展到线对点等

GIS 所表现的地理数据多维性使得传统的 B 树索引并不适用，因为 B 树所针对的字符、数字等传统数据类型是在一个良序集之中，即都是在一个维度上，集合中任给两个元素，都可以在这个维度上确定其关系只可能是大于、小于、等于三种，若对多个字段进行索引，必须指定各个字段的优先级形成一个组合字段，而地理数据的多维性，在任何方向上并不存在优先级问题，因此B树并不能对地理数据进行有效的索引，所以需要研究特殊的能适应多维特性的空间索引方式。

空间筛选的大致流程基本都是
1. 矩形框初筛，通过待查询矩形框与数据外包矩形相交快速判断
2. 对筛选后缩小了的数据集进行相交、包含、相切、相离等精准判断

空间索引的算法优劣，主要在于如何减少无关数据的访问次数

空间数据至少是二维数据，常用的一维索引（如 BTree/Bitmap 索引等）无法满足需求，常用的空间索引算法有 BSP 树、KD 树、R 树、R+ 树、四叉树和 CELL 树。

资料集合
* [深入理解空间搜索算法 ——数百万数据中的瞬时搜索](https://www.cnblogs.com/arxive/p/8138586.html)
* [A dive into spatial search algorithms](https://blog.mapbox.com/a-dive-into-spatial-search-algorithms-ebd0c5e39d2a)
## 为什么要重构
重构是一种对软件内部结构的改善，目的是在不改变软件的可见行为的情况下，使其更易理解，修改成本更低。

> 在保证功能不变的前提下， 利用设计思想、原则、模式、编程规范等理论来优化代码，修改设计上的不足，提高代码质量

为什么要重构
* 时刻保证代码质量的一个及其有效的手段，不至于让代码腐化到无可救药的地步
* 优秀的代码或架构不是一开始就能完全设计好的，就像优秀的公司和产品也都是迭代出来的。无法 100% 预见未来的需求，也没有足够的精力、时间、资源为遥远的未来买单，随着系统的演进，重构代码也是不可避免的
* 重构是避免过度设计的有效手段，在维护代码的过程中，真正遇到问题的时候，在对代码进行重构，能有效避免前期投入太多时间做过度的设计，做到有的放矢
* 重构对一个工程师本身技术的成长也有重要的意义

> 初级工程师在维护代码，高级工程师在设计代码，资深工程师在重构代码

到底重构什么
* 大型重构
  * 对顶层代码设计的重构，包括：系统、模块、代码结构、类与类之间的关系等的重构
  * 重构手段：分层、模块化、解耦、抽象可复用组件、梳理类之间的交互关系
  * 重构工具：设计思想、原则和模式
* 小型重构
  * 代码系统的重构，针对类、函数、变量等代码级别的重构，比如规范命名、规范注释、消除超大类或函数、修正函数参数多过、提取重复代码等
  * 重构手段：编码规范

什么时候重构
* 不推荐：平时不注重代码质量，堆砌蓝代码，实在维护不了就大刀阔斧地重构、甚至重写的行为，希望在代码烂到一定程度之后，集中重构解决所有问题是不现实的，必须探索一条**可持续、可演进**的方式
* 推荐：持续重构
  * 平时没事的时候多看看项目中有哪些写得不够好的地方，可以优化的地方，主动去重构一下
  * 修改、添加某个功能代码的时候，顺手把不符合编码规范、不好的设计重构一下

重构能力很重要，但持续重构意识更重要
* 正确看待代码质量和重构这件事情，技术更新、需求变化、人员流动，代码质量总会下降，代码总会存在不完美，重构就会持续进行
* 时刻具有持续重构意识，才能避免开发初期就过度设计，避免代码维护的过程中质量的下降

如何重构
* 大型重构
  * 完善的重构计划，有条不紊的分阶段来进行
  * 每个阶段完成一小部分代码的重构，然后提交、测试、运行，发现没有问题之后，在继续进行下一阶段的重构，保证代码仓库一直处于可运行、逻辑正确的状态
  * 控制好重构影响到的代码范围，考虑好如何兼容老的代码逻辑，必要的时候还需要写一些兼容过渡代码
  * 只有这样才能让每一阶段的重构都不至于耗时太长（最好一天就能完成），不至于和新的功能开发相冲突
* 小规模：随时都可以

对于重构这件事情，资深的工程师、项目 leader 要负责起来，没事就重构一下代码，时刻保证代码质量处在一个良好的状态。否则一旦出现破窗效应，就会有更多的人往里堆更烂的代码

> 很多技术问题本身就不是单纯靠技术来解决的，更重要的是要有这种认知和意识